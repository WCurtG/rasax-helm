#!/bin/bash

set -e

boolean() {
  case $1 in
    true) echo true ;;
    false) echo false ;;
    *) echo "Err: Unknown boolean value \"$1\"" 1>&2; exit 1 ;;
   esac
}

INSTALLER_DEBUG_MODE=$(boolean "${INSTALLER_DEBUG_MODE:-false}")

# The script can either use `wget` or `curl` to pull other scripts
DOWNLOADER=

if $INSTALLER_DEBUG_MODE
then
  set +x
  REDIRECT=/dev/stdout
else
  REDIRECT=/dev/null
fi

# Helper functions
echo_success() {
  echo -e "\e[32m${1}\e[0m"
}

echo_bold() {
  echo -e "\e[1m${1}\e[0m"
}

fatal() {
  echo "$@" >&2
  exit 1
}

seperator() {
  yes = | head -n$(($(tput cols) * 1)) | tr -d '\n'
  printf "\n \n $($1 "$2") \n \n"
  yes = | head -n$(($(tput cols) * 1)) | tr -d '\n'
}

does_command_exist() {
  command -v "$1" > /dev/null
}

install_docker () {
    echo "Installing docker ..."
    sudo apt install docker.io docker-compose &&
    # curl -fsSL https://get.docker.com -o get-docker.sh > ${REDIRECT}
    # sh get-docker.sh
    # Check if the `docker` command is available
    if ! does_command_exist "docker"
    then
      fatal "Something went wrong when trying to install the docker command line interface.\
      This is required for Rasa X deployment."
    fi
}   

install_docker && 
seperator echo_success "docker has been installed"

